# 以太坊

## 背景

Vitalik Buterin在2013年发表了一篇名为《以太坊：终极智能合约与去中心化应用程序平台》的博客，其中他首次提出“以太坊”这个概念，并介绍了一种“图灵完备区块链”的理念——时间和资源充足的去中心化计算机可以运行任何应用程序。

## 什么是以太坊？

以太坊（Ethereum）是一个建立在区块链技术上的去中心化应用平台。它允许任何人在平台中建立和使用通过区块链技术运行的去中心化应用。我们姑且可以理解为以太坊是区块链里的Android，它是一个开发平台，让我们可以像基于Android Framwork一样基于区块链技术写应用。

在没有以太坊之前，写区块链应用是这样的：拷贝一份比特币代码，然后去改底层代码如加密算法，共识机制，网络协议等等（很多山寨币就是这样，改改就出来一个新币）。

以太坊平台对底层区块链技术进行了封装，让区块链应用开发者可以直接基于以太坊平台进行开发，只要专注于开发应用本身逻辑的智能合约，这样就可以大大降低开发难度。

## 以太坊与比特币的区别

比特币通常被视为第一代区块链，其支持参与者在个人计算机中运行程序，让用户能够在去信任化、去中心化的环境中就金融数据库的状态达成一致意见。开发者考虑到安全性的因素，不愿把比特币打造成过于复杂的系统，在设计上显得缺乏灵活性。同时比特币智能合约的语言极为受限（非图灵完备），无法很好适应交易之外的应用程序。

相比之下，作为第二代区块链的以太坊，其功能更加的丰富。除了金融交易外，以太坊还实现了更高程度的可编程性。以太坊赋予开发人员更高的自由度，允许其试验个人代码，创造出各种去中心化应用程序（DApp）。

## 智能合约

以太坊网络上运行程序就称为智能合约，它和其他的程序一样，也是代码和数据(状态)的集合。

智能合约（Smart Contract）和人工智能（Artificial Intelligence ）的智能没有关系，智能合约最早由尼克萨博在95年提出，它的概念很简单，就是将法律条文写成可执行代码。让法律条文的执行中立化，这个理念和区块链上的程序可以不被篡改、不被干预（只有有人触发交易，它将自动执行）的执行不谋而合，因此区块链引入了这个概念。

比特币的交易是可以编程的，使用的是比特币脚本。但是比特币脚本有很多的限制，能够编写的程序也有限。而以太坊程序则是”图灵完备的“，因此理论上我们可以编写能够做任何事情的程序。

智能合约非常适合对信任、安全和持久性要求较高的应用场景，比如：数字货币、数字资产、投票、保险、金融应用、预测市场、产权所有权管理、物联网、点对点交易等等。

### 编程语言：Solidity

智能合约现在的主要编程语言是Solidity和Vyper，其中Solidity更为成熟一些，Solidity的合约拓展名为*.sol*。代码被编译为以太坊虚拟机字节码之后，再部署到以太坊网络。以太坊为我们提供了很好的工具来完成这项工作，比如：Remix就是用来开发、编译、部署智能合约的IDE，它还是一个基于浏览器的Web IDE。

此外，Solidity还是静态类型语言，支持继承、库和复杂的用户定义类型等特性。

## [以太坊节点](以太坊节点.md)

以太坊节点指的是以某种方式与以太坊网络交互的程序。从简单的手机钱包应用程序到存储整个区块链副本的计算机，任何设备均可扮演以太坊节点。其中主要包括以太坊全节点、以太坊轻节点、以太坊挖矿节点。

## [以太坊共识](以太坊共识.md)

比特币中使用的共识机制为PoW（工作量证明），在以太坊1.0中，也是通过工作量证明来验证区块。而在以太坊2.0中，以太坊通过名为Casper的升级操作从PoW过度到PoS（权益证明）。在该机制下，验证者明确地通过以太币将资本质押到以太坊上的智能合约中。这些质押的以太币充当抵押品，若验证者有失信行为或者消极怠工，则会销毁抵押品。

## 以太坊燃料费与燃料费限额

在以太坊中引入了**燃料费**（并不是费用，而是花费的燃料量）这一概念，如同汽车无法在燃料耗尽的情况下行驶，合约也不能在没有燃料费的情况下运行。而燃料费与合约的复杂度和难度有关，复杂度越高的合约其所需支付的燃料费也就越高。利用这一点可以很好规避一些长时间的循环程序，因为这意味着需要支付非常高额的燃料费。

在交易时，需要使用以太币支付燃料费。燃料费通常只消耗一小部分以太币，并设置了一个单位“ gwei ”。其中1gwei相当于以太币的十亿分之一。如果网络拥挤并且许多用户都在参与交易，燃料费的均价就会上涨。相反，如果交易量少，均价也会下降。

虽然燃料费的价格不断变化，但是每次操作所需的燃料费是固定的。也就是说，执行复杂合约消耗的燃料费要高于简单交易。可以说，**燃料费成为算力度量的标准**，其可以确保系统根据用户的以太坊资源占用率收取相应费用。

在进行合约交易时，你可以计算出需要支付的燃料费（通过ETH Gas Station）。你可以设置一个较高的价格来激励矿工尽快处理交易。同时，你也可以设置**燃料费限额**，用于自我保护。当合约出现问题时，消耗的燃料费可能会高于计划值。因此燃料费限额的作用就是在设置的燃料费耗尽后，确保操作停止，相应的合约就会失效。如果执行结束还有燃料费剩余，那么这些燃料费就会返还给用户。

简而言之，燃料费决定了矿工处理交易的速度，而燃料费限额则决定用户愿意为此交易支付的燃料费上限。

## 以太坊钱包

我们可以将以太币存入个人钱包中，有热钱包和冷钱包两种选择。

### 热钱包

以某种方式连入互联网的数字货币钱包成为“热钱包”。它通常是一种移动或桌面应用程序，用户可以通过其查看余额或发送接收代币。热钱包连入网络，极易遭受攻击，但日常支付更加青睐这种便捷方式。Trust Wallet是一种便捷的移动钱包买，支持多种货币。

### 冷钱包

 冷钱包则是一种离线工作的数字货币钱包。这类钱包远离在线攻击向量，显著降低遭受攻击的概率。然而，冷钱包的便捷性一般不如热钱包。硬件钱包均属于冷钱包。

## [以太坊二层扩容](以太坊二层扩容.md)

随着以太坊使用人数的增多，区块链的容量已无法满足用户需求，因此扩容方案就此提出。

扩容的主要目的是在不影响去中心化和安全性的前提下，提升交易速度和交易吞吐量。而扩容也分为链上扩容和链下扩容。链上扩容需要更改的是以太坊协议（一层网络/主网），其中分片是主要链上扩容技术；链下扩容则是要与主网分开，在二层网络实现，因此也被称作二层扩容。二层扩容主要包括：卷叠（Rollups）、状态通道、Plasma、Validium、侧链等等。

## 以太坊质押

在工作量证明协议中，矿工负责保障网络的安全性。矿工不会作弊，因为一旦作弊就代表着其算力要超过全网算力的51%，这种做法会空耗电力并且基本无法成功。而权益证明并不存在这种博弈理论，而是通过其他加密货币经济学措施来保障网络的安全。

在权益证明中，验证者必须质押一定数量的代币才能获得验证权。如果节点试图作弊，那么其质押的代币也将会丢失；如果节点无响应或者脱机，这些代币也将逐渐耗尽。

## 去中心化金融（DeFi）
