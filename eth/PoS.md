# 权益证明机制（PoS）

## 什么是权益证明？

权益证明是**构成共识机制的基础**，区块链使用这些机制来实现分布式共识。 

在工作量证明共识机制中，矿工通过消耗能源来证明他们拥有资本以应对风险。 以太坊采用权益证明机制，在该机制下，验证者明确地通过以太币将资本质押到以太坊上的智能合约中。 这些质押的以太币充当抵押品，如果验证者有失信行为或者消极怠工，那么可以销毁抵押品。 之后，验证者负责检查在网络上传播的新区块是否有效，并偶尔自己也创建和传播新区块。

## PoS对比PoW的优势

* 能效更高 – 无需在工作量证明计算中使用大量能源
* 门槛更低、硬件要求下降 – 无需购买高性能硬件以便获得创建新区块的机会
* 中心化风险降低 – 权益证明应该可以增加保护网络安全的节点
* 由于能源需求低，发行较少的以太币就可以激励大家参与
* 与工作量证明相比，对不当行为的经济处罚让 51% 攻击的代价呈指数级增加
* 如果 51% 攻击是为了攻破加密经济的防御，那么社区可以求助于诚实链的社会恢复

## 验证者

要想作为验证者参与，用户必须向存款合约存入 32 个以太币并运行三种独立的软件：执行客户端、共识客户端和验证者。 存入以太币时，用户会进入一个激活队列，限制新验证者加入网络的速度。 激活后，验证者将从以太坊网络上的对等节点接收新区块。 区块中交付的交易会被重新执行，并且对区块签名进行检查以确保区块是有效的。 然后验证者在整个网络上发送支持该区块的投票（称为认证）。

在工作量证明中，生成区块的时间是由挖矿难度决定的，**而在权益证明中，节奏是固定的**。 权益证明以太坊中的时间分为时隙（12 秒）和时段（32 个时隙）。 在每个时隙中随机选择一位验证者作为区块提议者。 该验证者负责创建新区块并发送给网络上的其他节点。 另外在每个时隙中，都会随机选择一个验证者委员会，通过他们的投票确定所提议区块的有效性。

## 工作过程

在以太坊2.0中，验证者将通过在官方的存款合约(deposit contract) 中进行存款来质押至少32 ETH，该存款合约由以太坊基金会开发。验证者将下载和运行以太坊2.0客户端软件。在运行客户端软件时，验证者将被随机选中在以太坊2.0区块链上提议区块和对区块进行证明（以一定概率被选中，概率根据质押的ETH数量而定，质押越多，概率越高）。以正确的方式提议区块和证明区块的验证者，将以其质押金的一个百分比获得ETH奖励。

如果某个验证者未能保持在线并执行其计算职责，那该验证者的区块奖励将会适度减少，以此来激励验证者尽可能地保持在线。如果某个验证者试图恶意地攻击网络 (即验证不正确的数据历史)，那该验证者的所有或部分质押的 32 ETH 将被罚没。

在PoS 网络，用于抵御恶意参与者的加密经济激励机制更加强大。在PoW中，某次失败攻击的经济风险等同于攻击者为获得所需的哈希算力所消耗的电力成本；而在PoS中，发起攻击的成本等同于质押的ETH价值，因此惩罚金额也是如此。与更加抽象的电力成本相比，攻击者可能更担心直接拿质押的加密资金冒险来发起攻击。尽管失败的PoW攻击会导致电力成本的损失，而在PoS中的惩罚是罚没验证者的质押金，这相当于矿工在一次失败的攻击中烧毁了整个PoW服务器机群。简言之，PoS中为了网络的最大利益而行动的经济动机更加强烈。

***

参考文章：https://ethereum.org/zh/developers/docs/consensus-mechanisms/pos/